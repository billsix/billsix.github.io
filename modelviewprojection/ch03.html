<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Window Resizing and Proportionality - Demo 03 &mdash; Model View Projection 0.0.1 documentation</title>
      <link rel="stylesheet" href="static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="static/css/my_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="static/documentation_options.js"></script>
        <script src="static/jquery.js"></script>
        <script src="static/underscore.js"></script>
        <script src="static/doctools.js"></script>
    <script src="static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Moving the Paddles - Keyboard Input - Demo 04" href="ch04.html" />
    <link rel="prev" title="Draw A Rectange - Demo 02" href="ch02.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Model View Projection
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch01.html">Opening a Window - Demo 01</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch02.html">Draw A Rectange - Demo 02</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Window Resizing and Proportionality - Demo 03</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#problem-with-previous-demo">Problem With Previous Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-execute">How to Execute</a></li>
<li class="toctree-l2"><a class="reference internal" href="#purpose">Purpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="#keeping-the-paddles-proportional">Keeping the Paddles Proportional</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code">Code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#glfw-opengl-initialization">GLFW/OpenGL Initialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#set-to-draw-in-square-subsection-of-window">Set to Draw in Square Subsection Of Window</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-event-loop">The Event Loop</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ch04.html">Moving the Paddles - Keyboard Input - Demo 04</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch05.html">Add Translate Method to Vertex - Demo 05</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch06.html">Modelspace - Demo 06</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch07.html">Rotations - Demo 07</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch08.html">Rotation Fix Attempt 1 - Demo 08</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch09.html">Rotation Fixed - Sequence of Transformations - Demo 09</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch10.html">Camera Space - Demo 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch11.html">Relative Objects - Demo 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch12.html">Rotate the Square - Demo 12</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch13.html">Rotate the Square Around Paddle 1 - Demo 13</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch14.html">Adding Depth - Z axis Demo 14</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch15.html">Adding Depth - Enable Depth Buffer - Demo 15</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch16.html">Moving Camera in 3D Space - Demo 16</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch17.html">Game Controller - Demo 17</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch18.html">3D Perspective - Demo 18</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch19.html">Lambda Stack - Demo 19</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch20.html">Matrix Stacks - Demo 20</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch21.html">May be not needed Demo 21</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch22.html">OpenGL 3.3  Demo 22</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch23.html">Towards Standard Projection Matrix  Demo 23</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch24.html">Towards Standard Projection Matrix Pt 2 Demo 24</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch25.html">Towards Standard Projection Matrix Pt 3 Demo 25</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch26.html">Towards Standard Projection Matrix Pt 4 Demo 26</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch27.html">Towards Standard Projection Matrix Pt 5 Demo 26</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Model View Projection</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Window Resizing and Proportionality - Demo 03</li>
      <li class="wy-breadcrumbs-aside">
            <a href="sources/ch03.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="window-resizing-and-proportionality-demo-03">
<h1>Window Resizing and Proportionality - Demo 03<a class="headerlink" href="#window-resizing-and-proportionality-demo-03" title="Permalink to this headline">¶</a></h1>
<section id="problem-with-previous-demo">
<h2>Problem With Previous Demo<a class="headerlink" href="#problem-with-previous-demo" title="Permalink to this headline">¶</a></h2>
<p>Run Demo 2 again, but resize the window; first make it skinny,
and then wide.  Look at what happens to the rectangles.</p>
<figure class="align-center" id="id1">
<img alt="Demo 03" src="images/demo03.png" />
<figcaption>
<p><span class="caption-text">Demo 03</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="how-to-execute">
<h2>How to Execute<a class="headerlink" href="#how-to-execute" title="Permalink to this headline">¶</a></h2>
<p>On Linux or on MacOS, in a command prompt, type “python src/demo03/demo.py”.
On Windows, in a command prompt, type “python src\demo03\demo.py”.</p>
</section>
<section id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>Modify the previous demo, so that if the user resizes the window
of the OpenGL program, that the picture does not become distorted.</p>
<p>Create procedure to ensure proportionality.</p>
</section>
<section id="keeping-the-paddles-proportional">
<h2>Keeping the Paddles Proportional<a class="headerlink" href="#keeping-the-paddles-proportional" title="Permalink to this headline">¶</a></h2>
<p>In the previous demo, if the user resized the window, the paddles appear distorted,
as they were shrunk in one direction if the window became too thin or too fat.</p>
<figure class="align-center" id="id2">
<img alt="Yuck" src="images/disproportionate1.png" />
<figcaption>
<p><span class="caption-text">Yuck</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id3">
<img alt="Yuck" src="images/disproportionate2.png" />
<figcaption>
<p><span class="caption-text">Yuck</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Assume that this is a problem for the application we are making, how could
we solve it and keep proportionality regardless of the dimensions of the window?
Ideally, we would like to draw our paddles with
a black background within a square region in the center of the window, regardless of the dimensions
of the window.</p>
<p>OpenGL has a solution for us.  The <em>viewport</em> is a rectangular region contained
within the window into which OpenGL will render.  By specifing a viewport, OpenGL
will convert the normalized-device-coordinates
to the sub-window space of the viewport, instead of the whole
window.</p>
<figure class="align-center" id="id4">
<img alt="Nice" src="images/viewport.png" />
<figcaption>
<p><span class="caption-text">Nice</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>N.B, we now have 3 coordinate systems.  NDC, viewport, and screenspace.  In later sections,
we will will have many, many more.</p>
<figure class="align-center" id="id5">
<img alt="Demo 03" src="images/demo031.png" />
<figcaption>
<p><span class="caption-text">Demo 03</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Because we will only draw in a subset of the window, and because all subsequent
chapters will use this functionality, I have created a procedure for use
in all chapters. “draw_in_square_viewport” is a function.</p>
</section>
<section id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<section id="glfw-opengl-initialization">
<h3>GLFW/OpenGL Initialization<a class="headerlink" href="#glfw-opengl-initialization" title="Permalink to this headline">¶</a></h3>
<p>The setup code is the same as the previous demo’s setup.  Initialize GLFW.  Set the OpenGL version.
Create the window.  Set a key handler for closing.
Execute the event/drawing loop.  The only code showed in this book will be the relevant parts.
Consult the python source for the full, working code.</p>
<section id="set-to-draw-in-square-subsection-of-window">
<h4>Set to Draw in Square Subsection Of Window<a class="headerlink" href="#set-to-draw-in-square-subsection-of-window" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">57</span><span class="k">def</span> <span class="nf">draw_in_square_viewport</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</pre></div>
</div>
<ul class="simple">
<li><p>declare a function to configure OpenGL to draw only in a square subset of the monitor, i.e. the viewport</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">59</span>    <span class="n">glClearColor</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="linenos">60</span>    <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>set the clear color to be gray.  clear the color of every pixel in the whole frame buffer, not just the viewport</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">62</span>    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">glfw</span><span class="o">.</span><span class="n">get_framebuffer_size</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<span class="linenos">63</span>
<span class="linenos">64</span>    <span class="nb">min</span> <span class="o">=</span> <span class="n">width</span> <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;</span> <span class="n">height</span> <span class="k">else</span> <span class="n">height</span>
</pre></div>
</div>
<ul class="simple">
<li><p>figure out the minimum dimension of the window</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">66</span>    <span class="n">glEnable</span><span class="p">(</span><span class="n">GL_SCISSOR_TEST</span><span class="p">)</span>
<span class="linenos">67</span>    <span class="n">glScissor</span><span class="p">(</span>
<span class="linenos">68</span>        <span class="nb">int</span><span class="p">((</span><span class="n">width</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span>
<span class="linenos">69</span>        <span class="nb">int</span><span class="p">((</span><span class="n">height</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span>
<span class="linenos">70</span>        <span class="nb">min</span><span class="p">,</span>
<span class="linenos">71</span>        <span class="nb">min</span><span class="p">,</span>
<span class="linenos">72</span>    <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Enable the scissor test</p></li>
<li><p>the scissor test allows us to specify a region
of the framebuffer into which the opengl operations
will apply.  In this case, the color in every pixel in the framebuffer is gray.
By calling glScissor, we are setting a value in each fragment (i.e., pixel) on a square
region of pixels to be true (and false everywhere else) which means “only do the opengl call on these fragments,
ignore the others”.
As we will learn later, OpenGL stores much more information
per fragment (i.e. pixel) than just it’s current color.</p></li>
<li><p>Look at the image above of NDC superimposed on Screen Space.  From this,
the arguments sent to glScissor should be clear.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">74</span>    <span class="n">glClearColor</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="linenos">75</span>    <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>glClear will only update the square to black values.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">76</span>    <span class="n">glDisable</span><span class="p">(</span><span class="n">GL_SCISSOR_TEST</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>disable the scissor test, so now any opengl calls will
happen as usual.</p></li>
</ul>
<p>So we’ve drawn gray into a square, but any subsequent OpenGL calls
will still be drawn into the full framebuffer, as the viewport is
still set to the whole framebuffer.  But, we only want to draw within the black square.
We set the viewport again, so that the NDC coordinates
will be mapped the the region of screen coordinates
that we care about, which is the black square.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">78</span>    <span class="n">glViewport</span><span class="p">(</span>
<span class="linenos">79</span>        <span class="nb">int</span><span class="p">(</span><span class="mf">0.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span>
<span class="linenos">80</span>        <span class="nb">int</span><span class="p">(</span><span class="mf">0.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span>
<span class="linenos">81</span>        <span class="nb">min</span><span class="p">,</span>
<span class="linenos">82</span>        <span class="nb">min</span><span class="p">,</span>
<span class="linenos">83</span>    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="the-event-loop">
<h4>The Event Loop<a class="headerlink" href="#the-event-loop" title="Permalink to this headline">¶</a></h4>
<p>The event loop is just like the previous demo,
but this time we call the procedure to
ensure that we only draw in a square subset of
the window.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">86</span><span class="k">while</span> <span class="ow">not</span> <span class="n">glfw</span><span class="o">.</span><span class="n">window_should_close</span><span class="p">(</span><span class="n">window</span><span class="p">):</span>
<span class="linenos">87</span>    <span class="n">glfw</span><span class="o">.</span><span class="n">poll_events</span><span class="p">()</span>
<span class="linenos">88</span>
<span class="linenos">89</span>    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">glfw</span><span class="o">.</span><span class="n">get_framebuffer_size</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<span class="linenos">90</span>    <span class="n">glViewport</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
<span class="linenos">91</span>    <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">93</span>    <span class="n">draw_in_square_viewport</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The event loop is the same as the previous demo, except
that we call draw_in_square_viewport every frame at the beginning.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 95</span>    <span class="n">glColor3f</span><span class="p">(</span><span class="mf">0.578123</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="linenos"> 96</span>    <span class="n">glBegin</span><span class="p">(</span><span class="n">GL_QUADS</span><span class="p">)</span>
<span class="linenos"> 97</span>    <span class="n">glVertex2f</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">)</span>
<span class="linenos"> 98</span>    <span class="n">glVertex2f</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">)</span>
<span class="linenos"> 99</span>    <span class="n">glVertex2f</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="linenos">100</span>    <span class="n">glVertex2f</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="linenos">101</span>    <span class="n">glEnd</span><span class="p">()</span>
<span class="linenos">102</span>
<span class="linenos">103</span>    <span class="n">glColor3f</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="linenos">104</span>    <span class="n">glBegin</span><span class="p">(</span><span class="n">GL_QUADS</span><span class="p">)</span>
<span class="linenos">105</span>
<span class="linenos">106</span>    <span class="n">glVertex2f</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">)</span>
<span class="linenos">107</span>    <span class="n">glVertex2f</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">)</span>
<span class="linenos">108</span>    <span class="n">glVertex2f</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="linenos">109</span>    <span class="n">glVertex2f</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="linenos">110</span>    <span class="n">glEnd</span><span class="p">()</span>
<span class="linenos">111</span>
<span class="linenos">112</span>    <span class="n">glfw</span><span class="o">.</span><span class="n">swap_buffers</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ch02.html" class="btn btn-neutral float-left" title="Draw A Rectange - Demo 02" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ch04.html" class="btn btn-neutral float-right" title="Moving the Paddles - Keyboard Input - Demo 04" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, William Emerison Six.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>